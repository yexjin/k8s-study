# 컨테이너 이해

### 리눅스 컨테이너 기술로 구성 요소 격리

---

가상 머신을 사용해 각 마이크로서비스의 환경을 격리하는 대신 개발자들은 리눅스 컨테이너 기술로 눈을 돌렸다.

컨테이너에서 실행되는 프로세스는 다른 모든 프로세스와 마찬가지로 호스트 운영체제 내에서 실행된다. 그러나 프로세스 입장에서 보면 시스템과 운영체제에서 실행되는 유일한 프로세스인 것처럼 보인다. 여전히 다른 프로세스들과는 격리되어 있어서!

<Br>
<Br>

### 컨테이**너와 가상머신 비교**

---

**가상머신**

- 구성 요소 프로세스 뿐만 아니라 시스템 프로세스를 실행해야 하기 때문에 추가 컴퓨팅 리소스가 필요

**컨테이너**

- 훨씬 더 가벼움
- 동일한 하드웨어에서 더 많은 수의 소프트웨어 구성요소를 실행
- 애플리케이션이 소비하는 리소스만 소비하고 추가 프로세스의 오버헤드 X
- **각 애플리케이션 마다 하나의 컨테이너를 가져, 동일한 베어메탈에서 더 많은 애플리케이션을 적재**
- 컨테이너는 모두 동일한 OS(호스트 OS)에서 실행되므로 컨테이너는 시스템 서비스를 실행하지 않는다.

  - 즉, 가상머신처럼 실행할 때 부팅이 필요가 없고 컨테이너에서 실행되는 프로세스는 즉시 시작된다.

    <Br>
    <Br>

### 컨테이너 격리를 가능하게 하는 매커니즘 소개

---

1. **리눅스 네임스페이스**로, 각 프로세스가 시스템에 대한 독립된 뷰만 볼 수 있도록 한다.
2. **리눅스 컨트롤 그룹**으로, 프로세스가 사용할 수 있는 리소스의 양을 제한

<Br>
<Br>

### 리눅스 네임스페이스로 프로세스 격리

---

- 각 리눅스 시스템은 초기 구동 시 하나의 네임스페이스가 있다.
- 네임스페이스 = 파일시스템 + 프로세스 ID + 사용자 ID + 네트워크 인터페이스
- 여러 종류의 네임스페이스가 있기 때문에 프로세스는 하나의 네임스페이스에만 속하는 것이 아니라 여러 네임스페이스에 속할 수 있다.
- 각 네임스페이스는 특정 리소스 그룹을 격리하는데 사용
- 네임 스페이스의 종류
  - 마운트
  - 프로세스 ID
  - 네트워크
  - 프로세스간 통신
  - 호스트와 도메인 이름
  - 사용자 ID
- 각 컨테이너는 고유한 네트워크 네임스페이스를 사용하므로 각 컨테이너는 고유한 네트워크 인터페이스 세트를 볼 수 있다.

    <Br>
    <Br>

### 가상머신 이미지와 컨테이너 이미지

---

- 가상화 방식
  - 가상머신 이미지 : **하이퍼바이저를 사용하여 하나의 호스트 시스템에서 여러 개의 독립적인 가상 머신을 생성하는 방식**으로 각각의 운영체제, 커널, 응용 프로그램을가지고 있으며 호스트 시스템과 완전히 격리된 공간에서 동작
  - 컨테이너 이미지 : **컨테이너 엔진을 사용하여 여러 개의 격리된 프로세스를 실행하는 방식**으로, 이러한 프로세스는 호스트 시스템과 커널을 공유하고, 하나의 운영체제 이미지를 기반으로 하여 실행
- 이미지 크기
  - 가상머신 이미지 **: 각각의 운영체제, 커널, 응용 프로그램** 등을 가지고 있기 때문에 이미지 크기가 크다
  - 컨테이너 이미지 : **호스트 시스템과 커널을 공유하기 때문에 이미지 크기가 비교적 작다**. 이미지 생성시, 기존 이미지를 기반으로 하여 필요한 부분만 추가하거나 수정하는 방식을 사용하기 때문에 더욱 더 이미지 크기가 작아질 수 있다.
- 시작 시간
  - 가상머신 이미지 : **하이퍼 바이저를 시작하고 가상머신을 부팅**해야하므로 상대적으로 시작 시간이 오래 걸린다.
  - 컨테이너 이미지 : 이미지가 호스트 시스템에서 실행되고 있는 경우, 빠른 시작 시간을 보장한다. **이미지에 필요한 라이브러리와 응용 프로그램이 호스트 시스템에 이미 설치**되어 있기 때문이다.
